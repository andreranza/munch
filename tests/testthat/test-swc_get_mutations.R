# FIXME: Do we still need this function?

expected <- tibble(
  mMutationNumber = c(1000,1000,2300,2300,2744,
                      2744,3161,3161,3298,3298,3301,3432,3432,3432),
  cAbbreviation = c(NA,NA,"LU","LU","LU","LU",
                    "LU","LU","LU","LU","LU","LU","LU","LU"),
  mHistId.x = c(NA,NA,11864,12976,14501,
                11939,12827,12706,14946,12513,15379,15519,15519,
                15589),
  mId.x = c(NA,NA,1081,1101,1081,1087,
            1060,1061,1081,1092,1061,1081,1081,1099),
  mShortName.x = c(NA,NA,"Beromünster",
                   "Schwarzenbach","Beromünster","Gunzwil","Littau","Luzern",
                   "Beromünster","Neudorf","Luzern","Beromünster",
                   "Beromünster","Schenkon"),
  mAbolitionMode = c(NA,NA,"Change of area",
                     "Abolition","Change of area","Abolition","Abolition",
                     "Change of area","Change of area","Abolition",
                     "Reassignment to other d/c","Change of area","Change of area",
                     "Change of area"),
  mAbolitionDate = as.Date(c(NA,NA,"2004-08-31",
                     "2004-08-31","2008-12-31","2008-12-31","2009-12-31",
                     "2009-12-31","2012-12-31","2012-12-31","2012-12-31",
                     "2014-12-31","2014-12-31","2014-12-31")),
  mDateOfChange.x = as.Date(c(NA,NA,"2004-08-31",
                      "2004-08-31","2008-12-31","2008-12-31","2009-12-31",
                      "2009-12-31","2012-12-31","2012-12-31","2012-12-31",
                      "2014-12-31","2014-12-31","2014-12-31")),
  mHistId.y = c(12706,11864,14501,14501,
                14946,14946,15379,15379,15519,15519,15600,15663,
                15664,15663),
  mId.y = c(1061,1081,1081,1081,1081,
            1081,1061,1061,1081,1081,1061,1081,1099,1081),
  mShortName.y = c("Luzern","Beromünster",
                   "Beromünster","Beromünster","Beromünster","Beromünster",
                   "Luzern","Luzern","Beromünster","Beromünster","Luzern",
                   "Beromünster","Schenkon","Beromünster"),
  mAdmissionMode = c("First-time registration",
                     "First-time registration","Change of area","Change of area",
                     "Change of area","Change of area","Change of area",
                     "Change of area","Change of area","Change of area",
                     "Reassignment to other d/c","Change of area",
                     "Change of area","Change of area"),
  mAdmissionDate = as.Date(c("1960-01-01","1960-01-01",
                     "2004-09-01","2004-09-01","2009-01-01","2009-01-01",
                     "2010-01-01","2010-01-01","2013-01-01","2013-01-01",
                     "2013-01-01","2015-01-01","2015-01-01","2015-01-01")),
  mDateOfChange.y = as.Date(c("2009-12-31","2004-08-31",
                      "2008-12-31","2008-12-31","2012-12-31","2012-12-31",
                      "2012-12-31","2012-12-31","2014-12-31","2014-12-31",
                      "2013-01-01","2015-01-01","2015-01-01","2015-01-01")),
  mMutationDate = as.Date(c("1960-01-01","1960-01-01",
                    "2004-09-01","2004-09-01","2009-01-01","2009-01-01",
                    "2010-01-01","2010-01-01","2013-01-01","2013-01-01",
                    "2013-01-01","2015-01-01","2015-01-01","2015-01-01")),
  mMutationId = c("1960-01-01.1000",
                  "1960-01-01.1000","2004-09-01.2300","2004-09-01.2300",
                  "2009-01-01.2744","2009-01-01.2744","2010-01-01.3161",
                  "2010-01-01.3161","2013-01-01.3298","2013-01-01.3298",
                  "2013-01-01.3301","2015-01-01.3432","2015-01-01.3432",
                  "2015-01-01.3432")
)

test_that("swc_get_mutations() works", {
  expect_identical(
    swc_get_mutations(c(1061, 1081), canton = "LU") %>%
      mutate(mMutationId = as.character(mMutationId)),
    expected
  )
})
